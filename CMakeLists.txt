cmake_minimum_required    (VERSION 2.8.12)
enable_language           (ASM)
project                   (A)
file                      (GLOB src "${CMAKE_CURRENT_SOURCE_DIR}/src/A.c")
add_compile_options       (-Wno-write-strings -Wno-incompatible-pointer-types -Wfatal-errors -fPIC)
if(APPLE)
    add_compile_options(-I/usr/local/include/)
endif()
add_compile_options       (-fsanitize=address -fno-omit-frame-pointer -g)
add_link_options          (-fsanitize=address)
set(CMAKE_C_STANDARD      11)
set(CMAKE_C_COMPILER      gcc)
add_library               (A SHARED ${src})
target_link_libraries     (A ffi)
target_include_directories(A PRIVATE . ./src)
install                   (TARGETS A LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)
install                   (FILES src/A DESTINATION include)